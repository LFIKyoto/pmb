<!-- $Id: profil.tpl.html,v 1.5.2.2 2019-11-21 09:56:16 ngantier Exp $ -->
{% if empr.id_empr %}
{% else %}
	{{ msg.subs_intro_services }}
	{{ msg.subs_intro_explication | replace '!!nb_h_valid!!' empr.opac_websubscribe_valid_limit }}
{% endif %}

<div id='change-profil'>
	<div id="change-profil-container" >
		{% block profil_form %}
		<form name="empr_form" id="empr_form" action="./empr.php?lvl=change_profil&action=save" method="POST">
		{% endblock%}
			<table>
				<tbody>
					{% block empr_nom %}
						{% if empr.renewal_form_fields.empr_nom.display %}
						<tr {% if empr.renewal_form_fields.empr_nom.explanation %} title="{{ empr.renewal_form_fields.empr_nom.explanation }}"{% endif %} >
							<td>{{msg.profil_empr_nom}} {% if empr.renewal_form_fields.empr_nom.mandatory %}<sup>*</sup>{% endif %} :</td>
							<td>
								<input id="empr_nom" name="{{ prefix_name }}nom{{ suffix_name }}" type="text" value="{{ empr.empr_nom }}" {% if empr.renewal_form_fields.empr_nom.mandatory %}required {% endif %} {% if !empr.renewal_form_fields.empr_nom.alterable %}readonly {% endif %} />
							</td>
						</tr>
						{% endif %}
					{% endblock %}
					{% block empr_prenom %}
						{% if empr.renewal_form_fields.empr_prenom.display %}
						<tr {% if empr.renewal_form_fields.empr_prenom.explanation %} title="{{ empr.renewal_form_fields.empr_prenom.explanation }}"{% endif %} >
							<td>{{ msg.profil_empr_prenom}} {% if empr.renewal_form_fields.empr_prenom.mandatory %}<sup>*</sup>{% endif %} :</td>
							<td>
								<input id="empr_prenom" name="{{ prefix_name }}prenom{{ suffix_name }}" type="text" value="{{ empr.empr_prenom }}" {% if empr.renewal_form_fields.empr_prenom.mandatory %}required {% endif %} {% if !empr.renewal_form_fields.empr_prenom.alterable %}readonly {% endif %} />
							</td>
						</tr>
						{% endif %}
					{% endblock %}
					{% if empr.renewal_form_fields.empr_adr1.display %}
					<tr {% if empr.renewal_form_fields.empr_adr1.explanation %} title="{{ empr.renewal_form_fields.empr_adr1.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_adr1}} {% if empr.renewal_form_fields.empr_adr1.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							<input id="empr_adr1" name="{{ prefix_name }}adr1{{ suffix_name }}" type="text" value="{{ empr.empr_adr1 }}" {% if empr.renewal_form_fields.empr_adr1.mandatory %}required {% endif %} {% if !empr.renewal_form_fields.empr_adr1.alterable %}readonly {% endif %} />
						</td>
					</tr>
					{% endif %}
					{% if empr.renewal_form_fields.empr_adr2.display %}
					<tr {% if empr.renewal_form_fields.empr_adr2.explanation %} title="{{ empr.renewal_form_fields.empr_adr2.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_adr2}} {% if empr.renewal_form_fields.empr_adr2.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							<input id="empr_adr2" name="{{ prefix_name }}adr2{{ suffix_name }}" type="text" value="{{ empr.empr_adr2 }}" {% if empr.renewal_form_fields.empr_adr2.mandatory %}required {% endif %} {% if !empr.renewal_form_fields.empr_adr2.alterable %}readonly {% endif %} />
						</td>
					</tr>
					{% endif %}
					{% if empr.renewal_form_fields.empr_cp.display %}		
					<tr {% if empr.renewal_form_fields.empr_cp.explanation %} title="{{ empr.renewal_form_fields.empr_cp.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_cp}} {% if empr.renewal_form_fields.empr_cp.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							<input id="empr_cp" name="{{ prefix_name }}cp{{ suffix_name }}" type="text" value="{{ empr.empr_cp }}" {% if empr.renewal_form_fields.empr_cp.mandatory %}required {% endif %} {% if !empr.renewal_form_fields.empr_cp.alterable %}readonly {% endif %} />
						</td>
					</tr>
					{% endif %}
					{% if empr.renewal_form_fields.empr_ville.display %}
					<tr {% if empr.renewal_form_fields.empr_ville.explanation %} title="{{ empr.renewal_form_fields.empr_ville.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_ville}} {% if empr.renewal_form_fields.empr_ville.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							<input id="empr_ville" name="{{ prefix_name }}ville{{ suffix_name }}" type="text" value="{{ empr.empr_ville }}" {% if empr.renewal_form_fields.empr_ville.mandatory %}required {% endif %} {% if !empr.renewal_form_fields.empr_ville.alterable %}readonly {% endif %} />
						</td>
					</tr>
					{% endif %}
					{% if empr.renewal_form_fields.empr_pays.display %}
					<tr {% if empr.renewal_form_fields.empr_pays.explanation %} title="{{ empr.renewal_form_fields.empr_pays.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_pays}} {% if empr.renewal_form_fields.empr_pays.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							<input id="empr_pays" name="{{ prefix_name }}pays{{ suffix_name }}" type="text" value="{{ empr.empr_pays }}" {% if empr.renewal_form_fields.empr_pays.mandatory %}required {% endif %} {% if !empr.renewal_form_fields.empr_pays.alterable %}readonly {% endif %} />
						</td>
					</tr>
					{% endif %}
					{% block empr_mail %}
						{% if empr.renewal_form_fields.empr_mail.display %}
						<tr {% if empr.renewal_form_fields.empr_mail.explanation %} title="{{ empr.renewal_form_fields.empr_mail.explanation }}"{% endif %} >
							<td>{{ msg.profil_empr_mail}} {% if empr.renewal_form_fields.empr_mail.mandatory %}<sup>*</sup>{% endif %} :</td>
							<td>
								<input id="empr_mail" name="{{ prefix_name }}mail{{ suffix_name }}" type="email" value="{{ empr.empr_mail }}" {% if empr.renewal_form_fields.empr_mail.mandatory %}required {% endif %} {% if !empr.renewal_form_fields.empr_mail.alterable %}readonly {% endif %} />
							</td>
						</tr>
						{% endif %}
					{% endblock %}
					{% if empr.renewal_form_fields.empr_tel1.display %}
					<tr {% if empr.renewal_form_fields.empr_tel1.explanation %} title="{{ empr.renewal_form_fields.empr_tel1.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_tel1}} {% if empr.renewal_form_fields.empr_tel1.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							<input id="empr_tel1" name="{{ prefix_name }}tel1{{ suffix_name }}" type="text" value="{{ empr.empr_tel1 }}" {% if empr.renewal_form_fields.empr_tel1.mandatory %}required {% endif %} {% if !empr.renewal_form_fields.empr_tel1.alterable %}readonly {% endif %} />
						</td>
					</tr>
					{% endif %}
					{% if empr.renewal_form_fields.empr_tel2.display %}
					<tr {% if empr.renewal_form_fields.empr_tel2.explanation %} title="{{ empr.renewal_form_fields.empr_tel2.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_tel2}} {% if empr.renewal_form_fields.empr_tel2.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							<input id="empr_tel2" name="{{ prefix_name }}tel2{{ suffix_name }}" type="text" value="{{ empr.empr_tel2 }}" {% if empr.renewal_form_fields.empr_tel2.mandatory %}required {% endif %}  {% if !empr.renewal_form_fields.empr_tel2.alterable %}readonly {% endif %} />
						</td>
					</tr>
					{% endif %}
					{% if empr.renewal_form_fields.empr_prof.display %}
					<tr {% if empr.renewal_form_fields.empr_prof.explanation %} title="{{ empr.renewal_form_fields.empr_prof.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_prof}} {% if empr.renewal_form_fields.empr_prof.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							<input id="empr_prof" name="{{ prefix_name }}prof{{ suffix_name }}" type="text" value="{{ empr.empr_prof }}" {% if empr.renewal_form_fields.empr_prof.mandatory %}required {% endif %}  {% if !empr.renewal_form_fields.empr_prof.alterable %}readonly {% endif %} />
						</td>
					</tr>
					{% endif %}
					{% if empr.renewal_form_fields.empr_year.display %}
					<tr {% if empr.renewal_form_fields.empr_year.explanation %} title="{{ empr.renewal_form_fields.empr_year.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_year}} {% if empr.renewal_form_fields.empr_year.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							<input id="empr_year" name="{{ prefix_name }}year{{ suffix_name }}" type="number" value="{{ empr.empr_year }}" {% if empr.renewal_form_fields.empr_year.mandatory %}required {% endif %}  {% if !empr.renewal_form_fields.empr_year.alterable %}readonly {% endif %} />
						</td>
					</tr>
					{% endif %}
					{% if empr.renewal_form_fields.empr_categ.display %}
					<tr {% if empr.renewal_form_fields.empr_categ.explanation %} title="{{ empr.renewal_form_fields.empr_categ.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_categ}} {% if empr.renewal_form_fields.empr_categ.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							{% sqlvalue categs %}
								SELECT id_categ_empr AS id, libelle FROM empr_categ ORDER BY libelle
							{% endsqlvalue %}
							<select id="empr_categ" name="{{ prefix_name }}categ{{ suffix_name }}" {% if empr.renewal_form_fields.empr_categ.mandatory %}required{% endif %} {% if !empr.renewal_form_fields.empr_categ.alterable %}readonly onclick="return false;"{% endif %}>
								{% for categ in categs %}
									<option value="{{ categ.id }}" {% if categ.id == empr.empr_categ %}selected="selected"{% endif %}>{{ categ.libelle }}</option>
								{% endfor %}
							</select>
						</td>
					</tr>
					{% endif %}
					{% if empr.renewal_form_fields.empr_codestat.display %}
					<tr {% if empr.renewal_form_fields.empr_codestat.explanation %} title="{{ empr.renewal_form_fields.empr_codestat.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_codestat}} {% if empr.renewal_form_fields.empr_codestat.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							{% sqlvalue codestats %}
								SELECT idcode AS id, libelle FROM empr_codestat ORDER BY libelle
							{% endsqlvalue %}
							<select id="empr_codestat" name="{{ prefix_name }}codestat{{ suffix_name }}" {% if empr.renewal_form_fields.empr_codestat.mandatory %}required{% endif %} {% if !empr.renewal_form_fields.empr_codestat.alterable %}readonly onclick="return false;"{% endif %}>
								{% for codestat in codestats %}
									<option value="{{ codestat.id }}" {% if codestat.id == empr.empr_codestat %}selected="selected"{% endif %}>{{codestat.libelle}}</option>
								{% endfor %}
							</select>
						</td>
					</tr>
					{% endif %}
					{% if empr.renewal_form_fields.empr_sexe.display %}
					<tr {% if empr.renewal_form_fields.empr_sexe.explanation %} title="{{ empr.renewal_form_fields.empr_sexe.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_sexe}} {% if empr.renewal_form_fields.empr_sexe.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							<select id="empr_sexe" name="{{ prefix_name }}sexe{{ suffix_name }}" {% if empr.renewal_form_fields.empr_sexe.mandatory %}required{% endif %} {% if !empr.renewal_form_fields.empr_sexe.alterable %}readonly onclick="return false;"{% endif %}>
								<option value="1" {% if empr.empr_sexe == 1 %}selected="selected"{% endif %}>{{ msg.profil_empr_sexe_m }}</option>
								<option value="2" {% if empr.empr_sexe == 2 %}selected="selected"{% endif %}>{{ msg.profil_empr_sexe_f }}</option>
								<option value="0" {% if empr.empr_sexe == 0 %}selected="selected"{% endif %}>{{ msg.profil_empr_sexe_o }}</option>
							</select>
						</td>
					</tr>
					{% endif %}
					{% block empr_login %}
						{% if empr.renewal_form_fields.empr_login.display %}
						<tr {% if empr.renewal_form_fields.empr_login.explanation %} title="{{ empr.renewal_form_fields.empr_login.explanation }}"{% endif %} >
							<td>{{ msg.profil_empr_login}} {% if empr.renewal_form_fields.empr_login.mandatory %}<sup>*</sup>{% endif %} :</td>
							<td>
								<input id="empr_login" name="{{ prefix_name }}login{{ suffix_name }}" type="text" value="{{ empr.empr_login }}"  {% if empr.renewal_form_fields.empr_login.mandatory %}required {% endif %}  {% if !empr.renewal_form_fields.empr_login.alterable %}readonly{% endif %} />
							</td>
						</tr>
						{% endif %}
					{% endblock %}
					{% if empr.renewal_form_fields.empr_lang.display %}
					<tr {% if empr.renewal_form_fields.empr_lang.explanation %} title="{{ empr.renewal_form_fields.empr_lang.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_lang}} {% if empr.renewal_form_fields.empr_lang.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							{{ empr.languages_selector }}
						</td>
					</tr>
					{% endif %}
					{% if empr.renewal_form_fields.empr_location.display %}
					<tr {% if empr.renewal_form_fields.empr_location.explanation %} title="{{ empr.renewal_form_fields.empr_location.explanation }}"{% endif %} >
						<td>{{ msg.profil_empr_location}} {% if empr.renewal_form_fields.empr_location.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							{% sqlvalue locations %}
								select idlocation as id, location_libelle as libelle from docs_location where location_visible_opac=1 order by location_libelle
							{% endsqlvalue %}
							<select id="empr_location" name="{{ prefix_name }}location{{ suffix_name }}" {% if empr.renewal_form_fields.empr_location.mandatory %}required{% endif %} {% if !empr.renewal_form_fields.empr_location.alterable %}readonly onclick="return false;"{% endif %}>
								{% for location in locations %}
									<option value="{{ location.id }}" {% if empr.empr_location == location.id %}selected="selected"{% endif %}>{{ location.libelle }}</option>
								{% endfor %}
							</select>
						</td>
					</tr>
					{% endif %}					
					{% if empr.renewal_form_fields.empr_msg.display %}
					<tr {% if empr.renewal_form_fields.empr_msg.explanation %} title="{{ empr.renewal_form_fields.empr_msg.explanation }}"{% endif %} >
						<td>{{ msg.empr_msg}} {% if empr.renewal_form_fields.empr_msg.mandatory %}<sup>*</sup>{% endif %} :</td>
						<td>
							<textarea rows="5" cols="50" id="empr_msg" name="{{ prefix_name }}msg{{ suffix_name }}" {% if empr.renewal_form_fields.empr_msg.mandatory %}required {% endif %}  {% if !empr.renewal_form_fields.empr_msg.alterable %}readonly {% endif %} >{{ empr.empr_msg }}</textarea>
						</td>
					</tr>
					{% endif %}
					
					{% block empr_p_perso %}
						{% for cp in empr.p_perso %}
							{% if cp.renewal_form_field.display %}
								<tr class="empr_p_perso" {% if cp.renewal_form_field.explanation %}title="{{ cp.renewal_form_field.explanation }}"{% endif %}>
									<td>{{ cp.TITRE_CLEAN }} {% if cp.renewal_form_field.mandatory %}<sup>*</sup>{% endif %} :</td>
									<td>
										{{ cp.EDIT }}
										<script type="text/javascript">
											{% if cp.renewal_form_field.mandatory %}
												document.getElementById("{{ cp.NAME }}").setAttribute("required", "required");
											{% endif %}
											{% if !cp.renewal_form_field.alterable %}
												document.getElementById("{{ cp.NAME }}").setAttribute("readonly", "readonly");
											{% endif %}
										</script>
									</td>
								</tr>
							{% endif %}
						{% endfor %}
					{% endblock %}
					{% block captcha %}
						{% if empr.id_empr %}
						{% else %}
							<tr>
								<td> 
								</td> 
								<td> 
								<div id='captcha_container' >{{ empr.captcha }}</div>
								</td>
							</tr>	
							<tr>
								<td>
									<span>{{ msg.subs_f_verifcode}}</span>
								</td>
								<td>
									<input type='text' class='subsform' id='empr_verifcode' name='captcha_code' value=''/>
								</td>
							</tr>
						{% endif %}
					{% endblock %}
					{% block empr_other_properties %}
					{% endblock %}
				</tbody>
			</table>
			{% block profil_buttons %}
				{{ empr.p_perso.CHECK_SCRIPTS }}
				<div class='clear'></div>
				<input type="submit" class="bouton" value="{{ msg.77 }}"/>
				{% if global.empr_opac_account_deleted_status %}
					<input type=button class='bouton' id='delete_account_button' value="{{ msg.empr_delete_account }}" onClick="delete_account();" />
				{% endif %}
			{% endblock %}
		</form>
		{% block profil_script %}
			{% if global.empr_opac_account_deleted_status %}
				<script type='text/javascript'>
		            function delete_account() {
		                var div = document.createElement('div');
		                div.innerHTML = "{{ msg.empr_confirm_deleting_account }}";
		                var confirm_message = div.firstChild.nodeValue;                    
		                if (confirm(confirm_message)) {
		                    window.location = './empr.php?lvl=delete_account';
		                }
		            }                
		        </script>
			{% endif %}
		{% endblock %}
	</div>
</div>